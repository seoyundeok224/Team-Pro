{"ast":null,"code":"var _jsxFileName = \"/Users/thesueji/Desktop/team2/Team-Pro/building-outline-map/src/components/Map/NaverMap.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst NAVER_CLIENT_ID = process.env.REACT_APP_NAVER_ID;\nfunction NaverMap({\n  searchQuery\n}) {\n  _s();\n  const mapRef = useRef(null);\n  const mapInstance = useRef(null);\n  const markerRef = useRef(null);\n  const initMarkerRef = useRef(null);\n  const [isMapReady, setIsMapReady] = useState(false);\n  const [hasSearchedOnce, setHasSearchedOnce] = useState(false);\n\n  // 네이버 지도 스크립트 로드\n  const loadNaverScript = () => {\n    return new Promise((resolve, reject) => {\n      if (window.naver && window.naver.maps) {\n        resolve();\n        return;\n      }\n      const script = document.createElement('script');\n      script.src = `https://oapi.map.naver.com/openapi/v3/maps.js?ncpKeyId=${NAVER_CLIENT_ID}&submodules=geocoder`;\n      script.async = true;\n      script.defer = true;\n      script.onload = () => {\n        if (window.naver && window.naver.maps) {\n          resolve();\n        } else {\n          reject(new Error('네이버 지도 API 로딩 실패'));\n        }\n      };\n      script.onerror = reject;\n      document.head.appendChild(script);\n    });\n  };\n\n  // 지도 초기화\n  useEffect(() => {\n    loadNaverScript().then(() => {\n      const mapOptions = {\n        center: new window.naver.maps.LatLng(37.5665, 126.978),\n        zoom: 14,\n        zoomControl: true,\n        mapTypeControl: true,\n        mapTypeId: window.naver.maps.MapTypeId.NORMAL,\n        scaleControl: true,\n        logoControl: true,\n        padding: {\n          top: 10,\n          right: 10,\n          bottom: 10,\n          left: 10\n        },\n        mapDataControl: false,\n        zoomControlOptions: {\n          position: window.naver.maps.Position.BOTTOM_LEFT,\n          style: 2\n        }\n      };\n      if (mapRef.current) {\n        mapInstance.current = new window.naver.maps.Map(mapRef.current, mapOptions);\n        if (navigator.geolocation && !hasSearchedOnce) {\n          navigator.geolocation.getCurrentPosition(pos => {\n            const currPos = new window.naver.maps.LatLng(pos.coords.latitude, pos.coords.longitude);\n            mapInstance.current.setCenter(currPos);\n            mapInstance.current.setZoom(13);\n            initMarkerRef.current = new window.naver.maps.Marker({\n              position: currPos,\n              map: mapInstance.current\n            });\n          });\n        }\n        setIsMapReady(true);\n      }\n    }).catch(err => {\n      console.error('지도 로드 실패:', err);\n    });\n  }, [hasSearchedOnce]);\n\n  // 주소 검색 → 지도 이동\n  useEffect(() => {\n    if (!searchQuery || !isMapReady) return;\n    setHasSearchedOnce(true);\n\n    // 주소 포맷 정제\n    let refinedAddress = searchQuery.trim().replace(\"서울시\", \"서울\").replace(\"경기도\", \"경기\").replace(\"부산시\", \"부산\").replace(/\\s+/g, \" \");\n    console.log(\"정제된 주소:\", refinedAddress);\n\n    // 프록시 서버를 통해 Kakao API 호출\n    fetch(`http://localhost:4000/kakao/address?query=${encodeURIComponent(refinedAddress)}`).then(res => res.json()).then(data => {\n      console.log(\"📦 Kakao 응답:\", data); // ✅ 이 줄 추가됨\n\n      if (!data.documents || data.documents.length === 0) {\n        alert(\"주소 검색 실패: 해당 주소를 찾을 수 없습니다.\");\n        return;\n      }\n      const {\n        x,\n        y\n      } = data.documents[0]; // x: 경도, y: 위도\n      const location = new window.naver.maps.LatLng(y, x);\n      mapInstance.current.setCenter(location);\n      mapInstance.current.setZoom(16);\n      if (markerRef.current) {\n        markerRef.current.setMap(null);\n      }\n      markerRef.current = new window.naver.maps.Marker({\n        position: location,\n        map: mapInstance.current\n      });\n    }).catch(err => {\n      console.error(\"Kakao 주소 검색 오류:\", err);\n      alert(\"주소 검색 중 오류 발생\");\n    });\n  }, [searchQuery, isMapReady]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: mapRef,\n    style: {\n      width: '100%',\n      height: '100%'\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 129,\n    columnNumber: 10\n  }, this);\n}\n_s(NaverMap, \"aEi8F3dKSAQsgOn0EuuP6kP4Auw=\");\n_c = NaverMap;\nexport default NaverMap;\nvar _c;\n$RefreshReg$(_c, \"NaverMap\");","map":{"version":3,"names":["React","useEffect","useRef","useState","jsxDEV","_jsxDEV","NAVER_CLIENT_ID","process","env","REACT_APP_NAVER_ID","NaverMap","searchQuery","_s","mapRef","mapInstance","markerRef","initMarkerRef","isMapReady","setIsMapReady","hasSearchedOnce","setHasSearchedOnce","loadNaverScript","Promise","resolve","reject","window","naver","maps","script","document","createElement","src","async","defer","onload","Error","onerror","head","appendChild","then","mapOptions","center","LatLng","zoom","zoomControl","mapTypeControl","mapTypeId","MapTypeId","NORMAL","scaleControl","logoControl","padding","top","right","bottom","left","mapDataControl","zoomControlOptions","position","Position","BOTTOM_LEFT","style","current","Map","navigator","geolocation","getCurrentPosition","pos","currPos","coords","latitude","longitude","setCenter","setZoom","Marker","map","catch","err","console","error","refinedAddress","trim","replace","log","fetch","encodeURIComponent","res","json","data","documents","length","alert","x","y","location","setMap","ref","width","height","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/thesueji/Desktop/team2/Team-Pro/building-outline-map/src/components/Map/NaverMap.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\n\nconst NAVER_CLIENT_ID = process.env.REACT_APP_NAVER_ID;\n\nfunction NaverMap({ searchQuery }) {\n  const mapRef = useRef(null);\n  const mapInstance = useRef(null);\n  const markerRef = useRef(null);\n  const initMarkerRef = useRef(null);\n  const [isMapReady, setIsMapReady] = useState(false);\n  const [hasSearchedOnce, setHasSearchedOnce] = useState(false);\n\n  // 네이버 지도 스크립트 로드\n  const loadNaverScript = () => {\n    return new Promise((resolve, reject) => {\n      if (window.naver && window.naver.maps) {\n        resolve();\n        return;\n      }\n\n      const script = document.createElement('script');\n      script.src = `https://oapi.map.naver.com/openapi/v3/maps.js?ncpKeyId=${NAVER_CLIENT_ID}&submodules=geocoder`;\n      script.async = true;\n      script.defer = true;\n      script.onload = () => {\n        if (window.naver && window.naver.maps) {\n          resolve();\n        } else {\n          reject(new Error('네이버 지도 API 로딩 실패'));\n        }\n      };\n      script.onerror = reject;\n\n      document.head.appendChild(script);\n    });\n  };\n\n  // 지도 초기화\n  useEffect(() => {\n    loadNaverScript()\n      .then(() => {\n        const mapOptions = {\n          center: new window.naver.maps.LatLng(37.5665, 126.978),\n          zoom: 14,\n          zoomControl: true,\n          mapTypeControl: true,\n          mapTypeId: window.naver.maps.MapTypeId.NORMAL,\n          scaleControl: true,\n          logoControl: true,\n          padding: { top: 10, right: 10, bottom: 10, left: 10 },\n          mapDataControl: false,\n          zoomControlOptions: {\n            position: window.naver.maps.Position.BOTTOM_LEFT,\n            style: 2,\n          },\n        };\n\n        if (mapRef.current) {\n          mapInstance.current = new window.naver.maps.Map(mapRef.current, mapOptions);\n\n          if (navigator.geolocation && !hasSearchedOnce) {\n            navigator.geolocation.getCurrentPosition((pos) => {\n              const currPos = new window.naver.maps.LatLng(pos.coords.latitude, pos.coords.longitude);\n              mapInstance.current.setCenter(currPos);\n              mapInstance.current.setZoom(13);\n              initMarkerRef.current = new window.naver.maps.Marker({\n                position: currPos,\n                map: mapInstance.current,\n              });\n            });\n          }\n\n          setIsMapReady(true);\n        }\n      })\n      .catch((err) => {\n        console.error('지도 로드 실패:', err);\n      });\n  }, [hasSearchedOnce]);\n\n  // 주소 검색 → 지도 이동\n  useEffect(() => {\n    if (!searchQuery || !isMapReady) return;\n\n    setHasSearchedOnce(true);\n\n    // 주소 포맷 정제\n    let refinedAddress = searchQuery\n      .trim()\n      .replace(\"서울시\", \"서울\")\n      .replace(\"경기도\", \"경기\")\n      .replace(\"부산시\", \"부산\")\n      .replace(/\\s+/g, \" \");\n\n    console.log(\"정제된 주소:\", refinedAddress);\n\n    // 프록시 서버를 통해 Kakao API 호출\n    fetch(`http://localhost:4000/kakao/address?query=${encodeURIComponent(refinedAddress)}`)\n      .then((res) => res.json())\n      .then((data) => {\n        console.log(\"📦 Kakao 응답:\", data);  // ✅ 이 줄 추가됨\n\n        if (!data.documents || data.documents.length === 0) {\n          alert(\"주소 검색 실패: 해당 주소를 찾을 수 없습니다.\");\n          return;\n        }\n\n        const { x, y } = data.documents[0]; // x: 경도, y: 위도\n        const location = new window.naver.maps.LatLng(y, x);\n\n        mapInstance.current.setCenter(location);\n        mapInstance.current.setZoom(16);\n\n        if (markerRef.current) {\n          markerRef.current.setMap(null);\n        }\n\n        markerRef.current = new window.naver.maps.Marker({\n          position: location,\n          map: mapInstance.current,\n        });\n      })\n      .catch((err) => {\n        console.error(\"Kakao 주소 검색 오류:\", err);\n        alert(\"주소 검색 중 오류 발생\");\n      });\n  }, [searchQuery, isMapReady]);\n\n  return <div ref={mapRef} style={{ width: '100%', height: '100%' }} />;\n}\n\nexport default NaverMap;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}